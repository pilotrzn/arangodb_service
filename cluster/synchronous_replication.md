# Синхронная репликация.

В кластере ArangoDB репликация между данными, хранящимися на серверах БД, является синхронной.

Синхронная репликация работает для каждого сегмента. Используя опцию replicationFactor, вы можете настроить для каждой коллекции, сколько копий каждого сегмента хранится в кластере.

Если коллекция имеет replicationFactor = 1, ее данные не реплицируются на другие DB-серверы. Это подвергает вас риску потери данных, если на компьютере, на котором запущен сервер БД с единственной копией данных, произойдет сбой.

Необходимо установить replicationFactor >= 2 для достижения минимальной избыточности данных с помощью синхронной репликации.

Необходимо установить replicationFactor >= 2 при создании коллекции, или вы можете настроить его позже, если забыли установить его во время создания. Вы также можете установить минимальный коэффициент репликации для всех коллекций, установив параметр запуска --cluster.min-replication-factor.

При использовании кластера убедитесь, что все важные коллекции (которые ни в коем случае не должны быть потеряны) имеют коэффициент репликации, равный или превышающий 2.

В любой момент времени одна из копий объявляется лидером, а все остальные копии являются последователями. Внутренне операции записи всегда отправляются на сервер базы данных, на котором хранится копия лидера, которая, в свою очередь, реплицирует изменения для всех последователей, прежде чем операция считается выполненной и сообщается Координатору. Внутри все операции чтения обслуживаются сервером БД, на котором хранится копия лидера, что позволяет обеспечить семантику моментальных снимков для сложных транзакций.

Использование только синхронной репликации гарантирует согласованность и высокую доступность за счет снижения производительности: запросы на запись имеют более высокую задержку (из-за того, что каждый запрос на запись должен выполняться для последователей), а запросы на чтение не масштабируются, поскольку запрашивается только лидер.

В кластере синхронная репликация управляется координаторами для клиента. Данные всегда хранятся на DB-серверах.

Синхронная репликация происходит за счет увеличения задержки операций записи потому что для каждого запроса в кластере требуется еще один сетевой переход. Поэтому пользователь может установить ReplicationFactor = 1, тем самым отключая синхронную репликацию. Это подходящий параметр для менее важных или легко восстанавливаемых данных, для которых важны операции записи с низкой задержкой.